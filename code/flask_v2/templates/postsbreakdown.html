{% extends "base2.html" %}

{% block content %}
{{ super() }}

<button onclick="toggle()" id="switchview"> Switch View </button>

<div class="postsbreakdown">


<div id="taggedentity">
<h1> Entity Tagged Posts </h1><br>

<!-- Select Entity to inspect -->
<span>
<b> Select an Entity: </b>
<select name="filter" method="GET" action="/postsbreakdown" id="choice" onchange="changeFrame()">
	<option value="{{entities[0]}}" selected>{{entities[0]}}</option>
	{% for entity in entities[1:] %}
	<option value="{{entity}}">{{entity}}</option>
	{% endfor %}
</select><br>
</span><br><br><br><hr>

<div id="chart">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.js'></script>
<h3> Average Sentiment over Time for Selected Entity </h3>
<canvas id="myChart"></canvas>
  <script>
var ctx = document.getElementById("myChart").getContext("2d");
 ctx.canvas.width = 400;
 ctx.canvas.height = 400;

 var dataMap = {
     'MEDICAL': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ med | tojson}}
             }],
         }
     },
     'SERVICE': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ med | tojson}}
             }],
         }
     },
     'IPPT': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ ippt | tojson}}
             }],
         }
     },
     'LOCATION': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ loc | tojson}}
             }],
         }
     },
     'CAMP': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ camp | tojson}}
             }],
         }
     },
     'FCC': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ fcc | tojson}}
             }],
         }
     },
     'ICT': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ ict | tojson}}
             }],
         }
     },
     'CMPB': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ cmpb | tojson}}
             }],
         }
     },
     'BMT': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ bmt | tojson}}
             }],
         }
     },
     'RT': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ rt | tojson}}
             }],
         }
     },
     'PORTAL': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ portal | tojson}}
             }],
         }
     },
     'TRAINING': {
         method: 'Line',
         data: {
             labels: {{ labels | tojson }},
             datasets: [{
                 label: "MEDICAL",
                 fillColor: "rgba(46, 204, 113,0.5)",
                 strokeColor: "rgba(220,220,220,0.8)",
                 highlightFill: "rgba(220,220,220,0.75)",
                 highlightStroke: "rgba(220,220,220,1)",
                 data: {{ training | tojson}}
             }],
         }
     }

   }


     

var currentChart;

 function updateChart() {
     if(currentChart){currentChart.destroy();}
   
     var determineChart = $("#choice").val();

     var params = dataMap[determineChart]
     currentChart = new Chart(ctx)[params.method](params.data, {});
 }

 $('#choice').on('change', updateChart)
 updateChart();
</script>

</div>


<iframe src="/display_spacy/SERVICE" id="viewent" class="iframe_posts"></iframe>
</div>	

<div id="sentencelevel" style="display:none">
<br><br>
<h1 style="text-align: center;"> Sentence Level Sentiment by Post </h1><br>
<br><br><hr>
<iframe src="/display_sentence_level" id="viewent" class="iframe_posts2"></iframe>

</div>


</div>


<script type="text/javascript">
function toggle() {
  var x = document.getElementById("taggedentity");
  var y = document.getElementById("sentencelevel");

  if (x.style.display === "none") {
  	y.style.display = "none";
    x.style.display = "block";
  } else {
  	y.style.display = "block";
    x.style.display = "none";
  }
}	

function changeFrame() {
	var choose = document.getElementById("choice").value;
	var base = "/display_spacy/"
	var loc = base.concat(choose)
	document.getElementById("viewent").src = loc

}








</script>








<style type="text/css">
.iframe_posts {
width: 860px;
height: 600px;
text-align: center;
margin: auto;
box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
  transition: 0.3s;
}

.iframe_posts:hover {
  box-shadow: 0 16px 32px 0 rgba(0,0,0,0.2);
}

.iframe_posts2 {
width: 800px;
height: 600px;
text-align: center;
margin: auto;
float: right;
box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
  transition: 0.3s;
}

.iframe_posts2:hover {
  box-shadow: 0 16px 32px 0 rgba(0,0,0,0.2);
}

#taggedentity {
	text-align: center;
}

#switchview {
  float: right;
}

#chart {
  float: left;
  margin-right: 60px;
}



</style>

{% endblock %}
